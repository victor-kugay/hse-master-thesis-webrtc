<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2336px" preserveAspectRatio="none" style="width:1092px;height:2336px;background:#FFFFFF;" version="1.1" viewBox="0 0 1092 2336" width="1092px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="36" x2="36" y1="36.2969" y2="2301.1797"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="441.5" x2="441.5" y1="36.2969" y2="2301.1797"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="848" x2="848" y1="36.2969" y2="2301.1797"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1060" x2="1060" y1="36.2969" y2="2301.1797"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="12" y="24.9951">ClientA</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="5" y="2300.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="12" y="2320.1748">ClientA</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="63" x="410.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="417.5" y="24.9951">ClientB</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="63" x="410.5" y="2300.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="417.5" y="2320.1748">ClientB</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="788" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="795" y="24.9951">SignalingServer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="788" y="2300.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="795" y="2320.1748">SignalingServer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="1034" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="1041" y="24.9951">STUN</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="1034" y="2300.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="1041" y="2320.1748">STUN</text><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="78" y1="97.6953" y2="97.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="78" y1="97.6953" y2="110.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="78" y1="110.6953" y2="110.6953"/><polygon fill="#181818" points="47,106.6953,37,110.6953,47,114.6953,43,110.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="43" y="62.3638">Запросить стрим с медиа</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="43" y="77.4966">данными</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178" x="43" y="92.6294">navigator.getUserMedia</text><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="78" y1="170.0938" y2="170.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="78" y1="170.0938" y2="183.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="78" y1="183.0938" y2="183.0938"/><polygon fill="#181818" points="47,179.0938,37,183.0938,47,187.0938,43,183.0938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="43" y="134.7622">Перенаправить стрим в</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="43" y="149.895">&lt;video /&gt; элемент</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188" x="43" y="165.0278">video.srcObject = stream</text><polygon fill="#181818" points="836,238.4922,846,242.4922,836,246.4922,840,242.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="842" y1="242.4922" y2="242.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="43" y="207.1606">Запросить список</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="43" y="222.2935">участников беседы</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="60" y="232.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="65" y="237.4263">socket.emit(join, ...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="848" x2="890" y1="286.7578" y2="286.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="890" x2="890" y1="286.7578" y2="299.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="849" x2="890" y1="299.7578" y2="299.7578"/><polygon fill="#181818" points="859,295.7578,849,299.7578,859,303.7578,855,299.7578" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="855" y="266.5591">Добавить нового участника</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="855" y="281.6919">беседы</text><polygon fill="#181818" points="453,355.1563,443,359.1563,453,363.1563,449,359.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="447" x2="847" y1="359.1563" y2="359.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="459" y="323.8247">Уведомить о новом</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="459" y="338.9575">участнике беседы</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="476" y="349.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="481" y="354.0903">socket.emit(addPeer, ...)</text><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="484" y1="403.4219" y2="403.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="484" x2="484" y1="403.4219" y2="416.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="484" y1="416.4219" y2="416.4219"/><polygon fill="#181818" points="453,412.4219,443,416.4219,453,420.4219,449,416.4219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="449" y="383.2231">Создать новый инстанс</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="449" y="398.356">RTCPeerConection</text><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="484" y1="460.6875" y2="460.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="484" x2="484" y1="460.6875" y2="473.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="484" y1="473.6875" y2="473.6875"/><polygon fill="#181818" points="453,469.6875,443,473.6875,453,477.6875,449,473.6875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="449" y="440.4888">Добавить RTCPeerConection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="449" y="455.6216">к списку участников беседы</text><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="484" y1="533.0859" y2="533.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="484" x2="484" y1="533.0859" y2="546.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="484" y1="546.0859" y2="546.0859"/><polygon fill="#181818" points="453,542.0859,443,546.0859,453,550.0859,449,546.0859" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="449" y="497.7544">Добавить локальный стрим</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="449" y="512.8872">в RTCPeerConection</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="466" y="523.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="471" y="528.02">connection.addSream()</text><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="484" y1="620.6172" y2="620.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="484" x2="484" y1="620.6172" y2="633.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="484" y1="633.6172" y2="633.6172"/><polygon fill="#181818" points="453,629.6172,443,633.6172,453,637.6172,449,633.6172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="449" y="570.1528">Добавить вывод</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="449" y="585.2856">полученного стрим в &lt;video</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="449" y="600.4185">/&gt;</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="466" y="610.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="471" y="615.5513">connection.onaddstream</text><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="484" y1="693.0156" y2="693.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="484" x2="484" y1="693.0156" y2="706.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="484" y1="706.0156" y2="706.0156"/><polygon fill="#181818" points="453,702.0156,443,706.0156,453,710.0156,449,706.0156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="449" y="657.6841">Добавить сериализацию</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="449" y="672.8169">данных из чата</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="392" x="449" y="687.9497">connection.ondatachannel,event.channel.onmessage</text><polygon fill="#181818" points="47,746.2813,37,750.2813,47,754.2813,43,750.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41" x2="847" y1="750.2813" y2="750.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="53" y="730.0825">Отправить список</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="53" y="745.2153">участников беседы</text><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="78" y1="809.6797" y2="809.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="78" y1="809.6797" y2="822.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="78" y1="822.6797" y2="822.6797"/><polygon fill="#181818" points="47,818.6797,37,822.6797,47,826.6797,43,822.6797" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="43" y="774.3481">Создать офер и описание</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45" x="43" y="789.481">сессии</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="60" y="799.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="65" y="804.6138">connection.createOffer()</text><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="78" y1="882.0781" y2="882.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="78" y1="882.0781" y2="895.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="78" y1="895.0781" y2="895.0781"/><polygon fill="#181818" points="47,891.0781,37,895.0781,47,899.0781,43,895.0781" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="43" y="846.7466">Добавить локальное</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="43" y="861.8794">описание сессии</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="60" y="872.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="65" y="877.0122">connection.setLocalDescription</text><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="78" y1="954.4766" y2="954.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="78" y1="954.4766" y2="967.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="78" y1="967.4766" y2="967.4766"/><polygon fill="#181818" points="47,963.4766,37,967.4766,47,971.4766,43,967.4766" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="43" y="919.145">Добавить локальный стрим</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="43" y="934.2778">в RTCPeerConection</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="60" y="944.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="65" y="949.4106">connection.addSream()</text><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="78" y1="1042.0078" y2="1042.0078"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="78" y1="1042.0078" y2="1055.0078"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="78" y1="1055.0078" y2="1055.0078"/><polygon fill="#181818" points="47,1051.0078,37,1055.0078,47,1059.0078,43,1055.0078" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="43" y="991.5435">Добавить вывод</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="43" y="1006.6763">полученного стрим в &lt;video</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="43" y="1021.8091">/&gt;</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="60" y="1032.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="65" y="1036.9419">connection.onaddstream</text><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="78" y1="1114.4063" y2="1114.4063"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="78" y1="1114.4063" y2="1127.4063"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="78" y1="1127.4063" y2="1127.4063"/><polygon fill="#181818" points="47,1123.4063,37,1127.4063,47,1131.4063,43,1127.4063" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="43" y="1079.0747">Добавить сериализацию</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="43" y="1094.2075">данных из чата</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="392" x="43" y="1109.3403">connection.ondatachannel,event.channel.onmessage</text><polygon fill="#181818" points="836,1197.9375,846,1201.9375,836,1205.9375,840,1201.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="842" y1="1201.9375" y2="1201.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="43" y="1151.4731">Отправить описание сессии</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="43" y="1166.606">участникам беседы</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="60" y="1176.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="65" y="1181.7388">socket.emit(relaySessionDescription,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="17" x="65" y="1196.8716">...)</text><polygon fill="#181818" points="453,1257.3359,443,1261.3359,453,1265.3359,449,1261.3359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="447" x2="847" y1="1261.3359" y2="1261.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="459" y="1226.0044">Уведомить о новом описании</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45" x="459" y="1241.1372">сессии</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="476" y="1251.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="481" y="1256.27">socket.emit(sessionDescription)</text><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="484" y1="1305.6016" y2="1305.6016"/><line style="stroke:#181818;stroke-width:1.0;" x1="484" x2="484" y1="1305.6016" y2="1318.6016"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="484" y1="1318.6016" y2="1318.6016"/><polygon fill="#181818" points="453,1314.6016,443,1318.6016,453,1322.6016,449,1318.6016" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="449" y="1285.4028">Создать новый инстанc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="449" y="1300.5356">RTCSessionDescription</text><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="484" y1="1378" y2="1378"/><line style="stroke:#181818;stroke-width:1.0;" x1="484" x2="484" y1="1378" y2="1391"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="484" y1="1391" y2="1391"/><polygon fill="#181818" points="453,1387,443,1391,453,1395,449,1391" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="449" y="1342.6685">Добавить описание сессии в</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="449" y="1357.8013">список удаленных сессий</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="203" x="449" y="1372.9341">peer.setRemoteDescription</text><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="484" y1="1435.2656" y2="1435.2656"/><line style="stroke:#181818;stroke-width:1.0;" x1="484" x2="484" y1="1435.2656" y2="1448.2656"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="484" y1="1448.2656" y2="1448.2656"/><polygon fill="#181818" points="453,1444.2656,443,1448.2656,453,1452.2656,449,1448.2656" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="449" y="1415.0669">Создать ответ</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140" x="449" y="1430.1997">peer.createAnswer</text><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="484" y1="1507.6641" y2="1507.6641"/><line style="stroke:#181818;stroke-width:1.0;" x1="484" x2="484" y1="1507.6641" y2="1520.6641"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="484" y1="1520.6641" y2="1520.6641"/><polygon fill="#181818" points="453,1516.6641,443,1520.6641,453,1524.6641,449,1520.6641" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="449" y="1472.3325">Добавить локальное</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="449" y="1487.4653">описание из createAnswer</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="449" y="1502.5981">peer.setLocalDescription</text><polygon fill="#181818" points="836,1576.0625,846,1580.0625,836,1584.0625,840,1580.0625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="842" y1="1580.0625" y2="1580.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="449" y="1544.731">Отправить описание сессии</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="449" y="1559.8638">участникам беседы</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="466" y="1570.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238" x="471" y="1574.9966">socket.emit(relaySessionDescription)</text><polygon fill="#181818" points="47,1620.3281,37,1624.3281,47,1628.3281,43,1624.3281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41" x2="847" y1="1624.3281" y2="1624.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="53" y="1604.1294">Уведомить об ответе</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="70" y="1614.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="75" y="1619.2622">socket.emit(sessionDescription)</text><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="78" y1="1668.5938" y2="1668.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="78" y1="1668.5938" y2="1681.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="78" y1="1681.5938" y2="1681.5938"/><polygon fill="#181818" points="47,1677.5938,37,1681.5938,47,1685.5938,43,1681.5938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="43" y="1648.395">Создать новый инстанc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="43" y="1663.5278">RTCSessionDescription</text><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="78" y1="1740.9922" y2="1740.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="78" y1="1740.9922" y2="1753.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="78" y1="1753.9922" y2="1753.9922"/><polygon fill="#181818" points="47,1749.9922,37,1753.9922,47,1757.9922,43,1753.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="43" y="1705.6606">Добавить описание сессии в</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="43" y="1720.7935">список удаленных сессий</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="203" x="43" y="1735.9263">peer.setRemoteDescription</text><polygon fill="#181818" points="1048,1779.125,1058,1783.125,1048,1787.125,1052,1783.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="1054" y1="1783.125" y2="1783.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="43" y="1778.0591">Запросить ICE кандидатов</text><polygon fill="#181818" points="47,1823.3906,37,1827.3906,47,1831.3906,43,1827.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="41" x2="1059" y1="1827.3906" y2="1827.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="53" y="1807.1919">Отдать список ICE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="53" y="1822.3247">кандидатов</text><polygon fill="#181818" points="836,1897.9219,846,1901.9219,836,1905.9219,840,1901.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="842" y1="1901.9219" y2="1901.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="43" y="1851.4575">Уведомить сигнальный</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="43" y="1866.5903">сервер о новом ICE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="43" y="1881.7231">кандидате</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="60" y="1891.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="65" y="1896.856">socket.emit(relayICECandidate)</text><polygon fill="#181818" points="453,1942.1875,443,1946.1875,453,1950.1875,449,1946.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="447" x2="847" y1="1946.1875" y2="1946.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="459" y="1925.9888">Уведомить клиента о новом</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="459" y="1941.1216">ICE кандидате</text><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="484" y1="2005.5859" y2="2005.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="484" x2="484" y1="2005.5859" y2="2018.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="484" y1="2018.5859" y2="2018.5859"/><polygon fill="#181818" points="453,2014.5859,443,2018.5859,453,2022.5859,449,2018.5859" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="449" y="1970.2544">Добавить ICE кандидата к</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="449" y="1985.3872">подключению</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="466" y="1995.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="471" y="2000.52">peer.addIceCandidate()</text><polygon fill="#181818" points="1048,2043.7188,1058,2047.7188,1048,2051.7188,1052,2047.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="1054" y1="2047.7188" y2="2047.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="449" y="2042.6528">Запросить ICE кандидатов</text><polygon fill="#181818" points="453,2087.9844,443,2091.9844,453,2095.9844,449,2091.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="447" x2="1059" y1="2091.9844" y2="2091.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="459" y="2071.7856">Отдать список ICE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="459" y="2086.9185">кандидатов</text><polygon fill="#181818" points="836,2162.5156,846,2166.5156,836,2170.5156,840,2166.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="442" x2="842" y1="2166.5156" y2="2166.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="449" y="2116.0513">Уведомить сигнальный</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="449" y="2131.1841">сервер о новом ICE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="449" y="2146.3169">кандидате</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="466" y="2156.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="471" y="2161.4497">socket.emit(relayICECandidate)</text><polygon fill="#181818" points="47,2206.7813,37,2210.7813,47,2214.7813,43,2210.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41" x2="847" y1="2210.7813" y2="2210.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="53" y="2190.5825">Уведомить клиента о новом</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="53" y="2205.7153">ICE кандидате</text><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="78" y1="2270.1797" y2="2270.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="78" y1="2270.1797" y2="2283.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="78" y1="2283.1797" y2="2283.1797"/><polygon fill="#181818" points="47,2279.1797,37,2283.1797,47,2287.1797,43,2283.1797" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="43" y="2234.8481">Добавить ICE кандидата к</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="43" y="2249.981">подключению</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="60" y="2260.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="65" y="2265.1138">peer.addIceCandidate()</text><!--MD5=[2782b35d3e0e5cf40b1e9aee5587fa35]
@startuml
skinparam maxMessageSize 200

participant ClientA
participant ClientB
participant SignalingServer
participant STUN

ClientA -> ClientA : Запросить стрим с медиа данными\n**navigator.getUserMedia**
ClientA -> ClientA : Перенаправить стрим в <video /> элемент\n**video.srcObject = stream**
ClientA -> SignalingServer : Запросить список участников беседы\n**socket.emit(join, ...)
SignalingServer -> SignalingServer : Добавить нового участника беседы
SignalingServer -> ClientB : Уведомить о новом участнике беседы\n**socket.emit(addPeer, ...)
ClientB -> ClientB : Создать новый инстанс RTCPeerConection
ClientB -> ClientB : Добавить RTCPeerConection к списку участников беседы
ClientB -> ClientB : Добавить локальный стрим в RTCPeerConection\n**connection.addSream()
ClientB -> ClientB : Добавить вывод полученного стрим в <video />\n**connection.onaddstream
ClientB -> ClientB : Добавить сериализацию данных из чата\n**connection.ondatachannel,event.channel.onmessage**
SignalingServer -> ClientA : Отправить список участников беседы
ClientA -> ClientA : Создать офер и описание сессии\n**connection.createOffer()
ClientA -> ClientA : Добавить локальное описание сессии\n**connection.setLocalDescription
ClientA -> ClientA : Добавить локальный стрим в RTCPeerConection\n**connection.addSream()
ClientA -> ClientA : Добавить вывод полученного стрим в <video />\n**connection.onaddstream
ClientA -> ClientA : Добавить сериализацию данных из чата\n**connection.ondatachannel,event.channel.onmessage**
ClientA -> SignalingServer : Отправить описание сессии участникам беседы\n**socket.emit(relaySessionDescription, ...)
SignalingServer -> ClientB : Уведомить о новом описании сессии\n**socket.emit(sessionDescription)
ClientB -> ClientB : Создать новый инстанc RTCSessionDescription
ClientB -> ClientB : Добавить описание сессии в список удаленных сессий\n**peer.setRemoteDescription**
ClientB -> ClientB : Создать ответ\n**peer.createAnswer**
ClientB -> ClientB : Добавить локальное описание из createAnswer\n**peer.setLocalDescription**
ClientB -> SignalingServer : Отправить описание сессии участникам беседы\n**socket.emit(relaySessionDescription)
SignalingServer -> ClientA : Уведомить об ответе\n**socket.emit(sessionDescription)
ClientA -> ClientA : Создать новый инстанc RTCSessionDescription
ClientA -> ClientA : Добавить описание сессии в список удаленных сессий\n**peer.setRemoteDescription**
ClientA -> STUN : Запросить ICE кандидатов
STUN - -> ClientA : Отдать список ICE кандидатов
ClientA -> SignalingServer : Уведомить сигнальный сервер о новом ICE кандидате\n**socket.emit(relayICECandidate)
SignalingServer -> ClientB : Уведомить клиента о новом ICE кандидате
ClientB -> ClientB : Добавить ICE кандидата к подключению\n**peer.addIceCandidate()

ClientB -> STUN : Запросить ICE кандидатов
STUN - -> ClientB : Отдать список ICE кандидатов
ClientB -> SignalingServer : Уведомить сигнальный сервер о новом ICE кандидате\n**socket.emit(relayICECandidate)
SignalingServer -> ClientA : Уведомить клиента о новом ICE кандидате
ClientA -> ClientA : Добавить ICE кандидата к подключению\n**peer.addIceCandidate()
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>